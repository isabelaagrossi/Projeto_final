{
  "hash": "8cb072f03180820d64ba36412a974d5e",
  "result": {
    "markdown": "---\ntitle: \"\"\n---\n\n\n## Teste *in vitro*\n\n### Pacotes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggthemes)\nlibrary(readxl)\nlibrary(DT)\nlibrary(drc) \nlibrary(patchwork)\nlibrary(ggplot2)\n```\n:::\n\n\n### Importando os dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\ndata <- read_xlsx(\"experimento_arroz.xlsx\")\nlibrary(DT)\ndatatable(data)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-48c8b0a6f083de471e1b\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-48c8b0a6f083de471e1b\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\"],[\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsAg\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\",\"NPsCu\"],[1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,4,4,4,4,4,5,5,5,5,5,0,0,0,0,0,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,4,4,4,4,4,5,5,5,5,5,0,0,0,0,0],[7.14,8.91,8.92,7.87,7.85,7.25,6.75,7.83,7.92,8.35,6.58,6.45,5.25,5.98,5.38,4.3,3.72,4.22,4,4.25,3.47,2.8,2.18,2.15,3.84,9,8.48,8.359999999999999,8.42,9,7.58,7.94,7.31,8.210000000000001,8.449999999999999,7.45,7.12,7.13,6.87,8.32,6.87,6.25,7.43,7.18,6.13,5.47,5.13,6.48,5.88,5.13,4.12,4.07,4.08,4.18,4.79,9,8.48,8.359999999999999,8.42,9]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>trat<\\/th>\\n      <th>dose<\\/th>\\n      <th>crescimento<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"trat\",\"targets\":1},{\"name\":\"dose\",\"targets\":2},{\"name\":\"crescimento\",\"targets\":3}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## Analise exploratoria\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata2 <- data |>\n  group_by(trat, dose) |> \n  summarise(growth_mean = mean(crescimento))\n\n data |> \n   ggplot(aes(dose, crescimento))+\n  geom_point()+\n  #geom_line()+\n  facet_wrap(~trat) +\n      labs(x = \"Dose (μL.L-1)\", y = \"Crescimento micelial (cm)\", title= \"Efeito de nanoparticulas no crescimento micelial\") +\n      theme_few()+\n    theme(plot.title = element_text(hjust = 0.5)) \n```\n\n::: {.cell-output-display}\n![](INVITRO_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n  data\n```\n:::\n\n\n## Analise para NPsCu:\n\n### Ajuste de modelo para regresão:\n\n#### Modelo linear\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncu <- data |> filter(trat == \"NPsCu\")\nm1 <- lm(crescimento ~ dose, data=cu)\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = crescimento ~ dose, data = cu)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.71383 -0.42930 -0.07289  0.24759  1.13806 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  8.86571    0.17145   51.71  < 2e-16 ***\ndose        -0.84189    0.05663  -14.87 8.15e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.5297 on 28 degrees of freedom\nMultiple R-squared:  0.8876,\tAdjusted R-squared:  0.8835 \nF-statistic:   221 on 1 and 28 DF,  p-value: 8.152e-15\n```\n:::\n:::\n\n\n#### Modelo quadratico:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm2=lm( crescimento ~ dose + I(dose^2), data = cu)\nsummary(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = crescimento ~ dose + I(dose^2), data = cu)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-0.7807 -0.3269 -0.1267  0.3482  0.9150 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  8.53143    0.19074  44.729  < 2e-16 ***\ndose        -0.34046    0.17941  -1.898  0.06849 .  \nI(dose^2)   -0.10029    0.03444  -2.912  0.00713 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4706 on 27 degrees of freedom\nMultiple R-squared:  0.9144,\tAdjusted R-squared:  0.9081 \nF-statistic: 144.3 on 2 and 27 DF,  p-value: 3.857e-15\n```\n:::\n:::\n\n\n#### Comparação dos modelos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAIC(m1, m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   df      AIC\nm1  3 50.94009\nm2  4 44.74804\n```\n:::\n:::\n\n\n### Representação grafica dos dois modelos de melhor ajuste para NPsCu:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nc <- cu |> \n  group_by(dose) |> \n  summarize(meancresc = mean(crescimento), sd=sd(crescimento))\n\n# Modelo linear\nc1 <- c |> \n  ggplot(aes(dose, meancresc))+\n  geom_point()+\n # scale_x_continuous(breaks = seq(7,22,2), limits = c(7,21))+\n  geom_smooth(se = F, formula = y ~ poly(x, 1), method = \"lm\", color = \"black\")+\n  theme_few()+\n  annotate(geom = \"text\",\n           x = 4.5, y = 8.5,\n           label = \"y = 8.87 - 0.84 x\n           R² = 0.88\",\n           hjust = 1,5)+ \n  geom_errorbar(aes(ymin = meancresc - sd, \n                    ymax = meancresc + sd), \n                width = 0.1) +\n   labs(y= \"Média do crescimento\", x= \"Dose\", title = 'Modelo linear') \n\n\n# Modelo quadratico\nc2 <- c |> \n  ggplot(aes(dose, meancresc))+\n  geom_point()+\n # scale_x_continuous(breaks = seq(7,22,2), limits = c(7,21))+\n  geom_smooth(se = F, formula = y ~ poly(x, 2), method = \"lm\", color = \"black\")+\n  theme_few()+\n  annotate(geom = \"text\",\n           x = 4.5, y = 8.5,\n           label = \"y = 8.53 - 0.34x - 0.1x²\n           R² = 0.91\",\n           hjust = 1,5)+ \n  geom_errorbar(aes(ymin = meancresc - sd, \n                    ymax = meancresc + sd), \n                width = 0.1) +\n  labs(y= \"\", x= \"Dose\", title = 'Modelo quadratico')\n\n\n\n(c1|c2)\n```\n\n::: {.cell-output-display}\n![](INVITRO_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n## Analises para NPsAg:\n\n### Ajuste de modelo para regresão:\n\n#### Modelo linear\n\n\n::: {.cell}\n\n```{.r .cell-code}\nag = data |> filter(trat == \"NPsAg\")\n  m1 =lm(crescimento ~ dose, data=ag)\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = crescimento ~ dose, data = ag)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.0255 -0.3891 -0.1757  0.6034  1.5203 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  9.26581    0.23467   39.48  < 2e-16 ***\ndose        -1.21806    0.07751  -15.71 2.02e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.725 on 28 degrees of freedom\nMultiple R-squared:  0.8982,\tAdjusted R-squared:  0.8945 \nF-statistic:   247 on 1 and 28 DF,  p-value: 2.025e-15\n```\n:::\n:::\n\n\n#### Modelo quadratico\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm2=lm( crescimento ~ dose + I(dose^2), data = ag)\nsummary(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = crescimento ~ dose + I(dose^2), data = ag)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.0117 -0.4536 -0.2225  0.5202  1.1840 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  8.74629    0.24893  35.136  < 2e-16 ***\ndose        -0.43877    0.23415  -1.874  0.07181 .  \nI(dose^2)   -0.15586    0.04495  -3.467  0.00178 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.6141 on 27 degrees of freedom\nMultiple R-squared:  0.9295,\tAdjusted R-squared:  0.9243 \nF-statistic: 178.1 on 2 and 27 DF,  p-value: 2.799e-16\n```\n:::\n:::\n\n\n#### Comparação dos modelos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAIC(m1, m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   df      AIC\nm1  3 69.77305\nm2  4 60.72449\n```\n:::\n:::\n\n\n### Representação grafica dos dois modelos de melhor ajuste:\n\n\n::: {.cell}\n\n```{.r .cell-code}\na <- ag |> \n  group_by(dose) |> \n  summarize(meancresc = mean(crescimento), sd=sd(crescimento))\n\n# Modelo linear\na1 <- a |> \n  ggplot(aes(dose, meancresc))+\n  geom_point()+\n # scale_x_continuous(breaks = seq(7,22,2), limits = c(7,21))+\n  geom_smooth(se = F, formula = y ~ poly(x, 1), method = \"lm\", color = \"black\")+\n  theme_few()+\n  annotate(geom = \"text\",\n           x = 4.5, y = 8.5,\n           label = \"y = 9.27 - 1.22 x\n           R² = 0.89\",\n           hjust = 1,5)+ \n  geom_errorbar(aes(ymin = meancresc - sd, \n                    ymax = meancresc + sd), \n                width = 0.1) +\n   labs(y= \"Média do crescimento\", x= \"Dose\", title = 'Modelo linear') \n\n\n# Modelo quadratico\na2 <- a |> \n  ggplot(aes(dose, meancresc))+\n  geom_point()+\n # scale_x_continuous(breaks = seq(7,22,2), limits = c(7,21))+\n  geom_smooth(se = F, formula = y ~ poly(x, 2), method = \"lm\", color = \"black\")+\n  theme_few()+\n  annotate(geom = \"text\",\n           x = 4.5, y = 8.5,\n           label = \"y = 8.75 - 0.44x - 0.16x²\n           R² = 0.92\",\n           hjust = 1,5)+ \n  geom_errorbar(aes(ymin = meancresc - sd, \n                    ymax = meancresc + sd), \n                width = 0.1) +\n   labs(y= \"\", x= \"Dose\", title = 'Modelo quadratico')\n\n(a1|a2)\n```\n\n::: {.cell-output-display}\n![](INVITRO_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n## EC50\n\n### Calculo do EC50 - NPsCu\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndrc1 <- drm(crescimento ~ dose, data = cu,\n    fct = LL.3())\nsummary(drc1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nModel fitted: Log-logistic (ED50 as parameter) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n              Estimate Std. Error t-value   p-value    \nb:(Intercept)  2.33344    0.42423  5.5004 7.965e-06 ***\nd:(Intercept)  8.35617    0.20363 41.0368 < 2.2e-16 ***\ne:(Intercept)  5.25965    0.24253 21.6864 < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 0.5089379 (27 degrees of freedom)\n```\n:::\n\n```{.r .cell-code}\nplot(drc1)\n```\n\n::: {.cell-output-display}\n![](INVITRO_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\nED(drc1, 50, interval = \"delta\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nEstimated effective doses\n\n       Estimate Std. Error   Lower   Upper\ne:1:50  5.25965    0.24253 4.76202 5.75729\n```\n:::\n:::\n\n\n### Calculo do EC50 - NPsAg\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndrc2 <- drm(crescimento ~ dose, data = ag,\n    fct = LL.3())\nsummary(drc2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nModel fitted: Log-logistic (ED50 as parameter) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n              Estimate Std. Error t-value   p-value    \nb:(Intercept)  2.97947    0.34067  8.7458 2.318e-09 ***\nd:(Intercept)  8.50271    0.19491 43.6245 < 2.2e-16 ***\ne:(Intercept)  3.95940    0.12170 32.5339 < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 0.5707139 (27 degrees of freedom)\n```\n:::\n\n```{.r .cell-code}\nplot(drc2)\n```\n\n::: {.cell-output-display}\n![](INVITRO_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n\n```{.r .cell-code}\nED(drc2, 50, interval = \"delta\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nEstimated effective doses\n\n       Estimate Std. Error  Lower  Upper\ne:1:50   3.9594     0.1217 3.7097 4.2091\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndadonano <- data.frame( Trat = c(\"NPsCu\", \"NPsAg\"),\n                       Estimate = c(5.25965, 3.9594 ),\n                       Lower = c(4.76202, 3.7097),\n                       Upper = c(5.75729, 4.2091))\n\ndatatable(dadonano)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-3968bbdcc7b13ed61079\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-3968bbdcc7b13ed61079\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\"],[\"NPsCu\",\"NPsAg\"],[5.25965,3.9594],[4.76202,3.7097],[5.75729,4.2091]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Trat<\\/th>\\n      <th>Estimate<\\/th>\\n      <th>Lower<\\/th>\\n      <th>Upper<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"Trat\",\"targets\":1},{\"name\":\"Estimate\",\"targets\":2},{\"name\":\"Lower\",\"targets\":3},{\"name\":\"Upper\",\"targets\":4}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplotEC <- dadonano |>\n  ggplot(aes(Trat, Estimate)) +\n  geom_point() +\n  ylim(1,10)+\n  geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.05) +  \n   geom_text(aes(label = round(Estimate, 2)), hjust = 1.2) +  \n  labs(x = \"Nanoparticula\", y = \"EC50\") + \n theme_few()\n\nplotEC\n```\n\n::: {.cell-output-display}\n![](INVITRO_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "INVITRO_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\r\n<link href=\"site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/datatables-binding-0.32/datatables.js\"></script>\r\n<script src=\"site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\r\n<link href=\"site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\r\n<link href=\"site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\r\n<link href=\"site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}